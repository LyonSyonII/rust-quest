---
interface Props {
  id: string;
}
const { id } = Astro.props;
---

<x-checkpoint
  style="display: none"
  data-id={id}
>
  <slot />
</x-checkpoint>

<style>
  @keyframes scaleanimation {
    0% {
      transform: scale(0);
    }
    100% {
      transform: scale(1);
    }
  }
  
  x-checkpoint {
    animation: scaleanimation 0.4s ease-in-out;
  }
</style>

<script>
  import { subscribe } from "./checkpoint";

  class Checkpoint extends HTMLElement {
    constructor() {
      super();
      const id = this.dataset.id as string;

      subscribe(id, async (s) => {
        if (!s.has(id)) {
          return;
        }

        // console.log({scroll, loaded, dataId: this.dataset.id, dataScroll: this.dataset.scroll});

        this.style.display = "block";
      });
    }
  }
  customElements.define("x-checkpoint", Checkpoint);
</script>
